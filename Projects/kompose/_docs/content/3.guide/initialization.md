---
title: Project Initialization
description: Complete guide to initializing Kompose for local development or production
---

Get your Kompose project set up correctly from the start with the interactive initialization wizard.

## Overview

The `kompose.sh init` command provides a guided, interactive setup experience that:

- âœ… Checks all system dependencies
- âœ… Configures environment files
- âœ… Installs project dependencies
- âœ… Sets up Docker networking
- âœ… Creates necessary directories
- âœ… Makes scripts executable

## Quick Start

After cloning the repository, run the initialization wizard:

```bash
cd kompose
./kompose.sh init
```

The wizard will guide you through:
1. Dependency checking
2. Environment selection (local vs production)
3. Configuration file setup
4. Dependency installation
5. Docker network creation
6. Project directory structure

## Prerequisites

### Required

Before running `init`, ensure you have:

- **Docker** 20.10+ installed and running
- **Docker Compose** v2.0+ (included with Docker Desktop)
- **Git** for repository management
- **Bash** 4.0+ shell

### Optional (Recommended for Development)

- **Node.js** 18+ for documentation and KMPS development
- **pnpm** package manager (`npm install -g pnpm`)
- **Python 3** for the REST API server

## Step-by-Step Initialization

### Step 1: Dependency Check

The wizard automatically checks for required dependencies:

```bash
âœ“ Docker: 24.0.6
âœ“ Docker Compose: 2.23.0
âœ“ Git: 2.42.0
âš  Node.js: NOT FOUND (optional)
âš  pnpm: NOT FOUND (optional)
âš  Python 3: 3.11.6
```

**If required dependencies are missing**, install them before continuing:

::code-group
```bash [Ubuntu/Debian]
# Install Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# Install Git
sudo apt-get install git

# Optional: Node.js and pnpm
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs
npm install -g pnpm
```

```bash [macOS]
# Install Docker Desktop from docker.com
# Or use Homebrew:
brew install --cask docker

# Install Git (usually pre-installed)
brew install git

# Optional: Node.js and pnpm
brew install node
npm install -g pnpm
```

```bash [Windows (WSL)]
# Install Docker Desktop for Windows with WSL2
# Then in WSL terminal:
sudo apt-get update
sudo apt-get install git

# Optional: Node.js and pnpm
curl -fsSL https://deb.nodesource.com/setup_20.x | sudo -E bash -
sudo apt-get install -y nodejs
npm install -g pnpm
```
::

### Step 2: Choose Environment

The wizard offers three setup options:

#### Option 1: Local Development (Recommended)

**Best for:**
- First-time setup
- Development and testing
- Learning Kompose

**Features:**
- No domain configuration needed
- Services on `localhost:PORT`
- Fast setup (~5 minutes)
- Direct database connections

**Services:**
```
PostgreSQL:      localhost:5432
Redis:           localhost:6379
MQTT:            localhost:1883
Keycloak:        http://localhost:8180
KMPS:            http://localhost:3100
Gitea:           http://localhost:3001
n8n:             http://localhost:5678
Home Assistant:  http://localhost:8123
```

#### Option 2: Production

**Best for:**
- Production deployments
- Public-facing services
- Full-featured setup

**Requirements:**
- Domain name with DNS access
- Server with public IP
- Email for SSL certificates

**Features:**
- Traefik reverse proxy with SSL
- Let's Encrypt certificates
- OAuth2 SSO integration
- Subdomain routing

#### Option 3: Both Environments

**Best for:**
- Teams with dev and prod needs
- Testing production configs locally
- Flexible deployment workflows

**Benefits:**
- Easily switch between modes
- Test production settings locally
- Separate configurations maintained

### Step 3: Configuration Files

The wizard creates or updates these files:

#### `.env` - Main Environment File

```bash
# Generated based on your choice
COMPOSE_PROJECT_NAME=kompose
DOCKER_NETWORK=kompose

# Local mode
TRAEFIK_ENABLED=false

# Production mode
TRAEFIK_ENABLED=true
TRAEFIK_HOST=${ROOT_DOMAIN}
```

#### `domain.env` - Domain Configuration

**Local mode:**
```bash
ROOT_DOMAIN=localhost
SUBDOMAIN_AUTH=auth
SUBDOMAIN_CHAIN=automation
SUBDOMAIN_CODE=code
```

**Production mode:**
```bash
ROOT_DOMAIN=example.com
ACME_EMAIL=admin@example.com
SSL_PROVIDER=letsencrypt

SUBDOMAIN_AUTH=auth
SUBDOMAIN_CHAIN=automation
SUBDOMAIN_CODE=code
# ... more subdomains
```

#### `secrets.env` - Sensitive Credentials

**Local mode** (development defaults):
```bash
# Development Secrets (Local Mode)
DB_PASSWORD=dev_password_123
REDIS_PASSWORD=dev_redis_123
KC_ADMIN_PASSWORD=admin
OAUTH2_CLIENT_SECRET=dev_oauth2_secret
OAUTH2_COOKIE_SECRET=<auto-generated>
```

**Production mode** (from template):
```bash
# Production Secrets
DB_PASSWORD=<CHANGE_ME>
REDIS_PASSWORD=<CHANGE_ME>
KC_ADMIN_PASSWORD=<CHANGE_ME>
OAUTH2_CLIENT_SECRET=<CHANGE_ME>
OAUTH2_COOKIE_SECRET=<auto-generated>
```

::alert{type="warning"}
**Important:** Always update `secrets.env` with strong passwords before starting services in production!
::

### Step 4: Project Dependencies

The wizard installs Node.js dependencies for:

**Documentation Site (`_docs`):**
- Nuxt 4 framework
- Nuxt Content for documentation
- Nuxt UI components
- PWA support

**KMPS Management Portal (`kmps`):**
- Next.js 14 framework
- Keycloak Admin Client
- NextAuth for authentication
- UI components

**Installation:**
```bash
ðŸ“¦ Installing documentation site dependencies...
âœ“ Documentation site dependencies installed

ðŸ“¦ Installing KMPS management portal dependencies...
âœ“ KMPS management portal dependencies installed
```

**If pnpm is not installed:**
```
âš  pnpm not found - skipping Node.js dependency installation

  To install pnpm later, run:
    npm install -g pnpm

  Then install dependencies with:
    cd _docs && pnpm install
    cd ../kmps && pnpm install
```

### Step 5: Docker Network

Creates the shared Docker network for all stacks:

```bash
âœ“ Created Docker network 'kompose'
```

All Kompose services use this network for inter-container communication.

### Step 6: Directory Structure

Creates necessary directories:

```
kompose/
â”œâ”€â”€ backups/
â”‚   â”œâ”€â”€ database/     # Database backup files
â”‚   â””â”€â”€ config/       # Configuration backups
â”œâ”€â”€ _docs/            # Documentation site
â”œâ”€â”€ kmps/             # Management portal
â””â”€â”€ <stack-dirs>/     # Individual stack directories
```

## Post-Initialization

### Local Development Setup

After initialization for local development:

1. **Review secrets:**
   ```bash
   nano secrets.env
   ```

2. **Start core services:**
   ```bash
   ./kompose.sh up core
   ```
   Wait for PostgreSQL, Redis, and MQTT to be ready (~30 seconds).

3. **Start authentication:**
   ```bash
   ./kompose.sh up auth
   ```
   Keycloak will be available at `http://localhost:8180`

4. **Configure Keycloak:**
   - Login: `admin` / (password from `secrets.env`)
   - Create realm: `kompose`
   - Create client: `kmps-portal`
   - Copy client secret to `secrets.env`

5. **Start KMPS:**
   ```bash
   ./kompose.sh up kmps
   ```
   Access at `http://localhost:3100`

6. **Start other stacks as needed:**
   ```bash
   ./kompose.sh up chain    # n8n automation
   ./kompose.sh up code     # Gitea
   ./kompose.sh up home     # Home Assistant
   ```

### Production Setup

After initialization for production:

1. **Configure DNS:**
   Create A records for:
   ```
   example.com           -> YOUR_SERVER_IP
   *.example.com         -> YOUR_SERVER_IP
   ```

2. **Update secrets with strong passwords:**
   ```bash
   nano secrets.env
   ```
   Generate strong passwords:
   ```bash
   openssl rand -base64 32
   ```

3. **Start Traefik (reverse proxy):**
   ```bash
   ./kompose.sh up proxy
   ```
   Wait for SSL certificates to be generated.

4. **Start core services:**
   ```bash
   ./kompose.sh up core
   ```

5. **Start authentication:**
   ```bash
   ./kompose.sh up auth
   ```
   Access at `https://auth.example.com`

6. **Configure Keycloak and continue...**

## Switching Environments

After initialization, you can switch between local and production modes:

### Switch to Local Development

```bash
./kompose.sh setup local
```

This will:
- Backup current configuration
- Activate `.env.local` and `domain.env.local`
- Use localhost addresses
- Disable Traefik

### Switch to Production

```bash
./kompose.sh setup prod
```

This will:
- Backup current configuration
- Activate `.env.production` and `domain.env.production`
- Enable Traefik with SSL
- Use domain-based routing

### Check Current Mode

```bash
./kompose.sh setup status
```

Output:
```
Current Mode: LOCAL DEVELOPMENT

Local Development Services:
  Core Services:
    PostgreSQL:      localhost:5432
    Redis:           localhost:6379
    MQTT:            localhost:1883
  ...
```

## Advanced Configuration

### Custom Domain Setup (Production)

Edit `domain.env` to customize subdomains:

```bash
# Custom subdomain structure
SUBDOMAIN_AUTH=sso           # https://sso.example.com
SUBDOMAIN_KMPS=portal        # https://portal.example.com
SUBDOMAIN_CHAIN=flows        # https://flows.example.com
SUBDOMAIN_CODE=git           # https://git.example.com
```

### Port Customization (Local)

Edit stack-specific `compose.yaml` files to change ports:

```yaml
# auth/compose.yaml
services:
  keycloak:
    ports:
      - "9000:8080"  # Changed from 8180:8080
```

### Network Isolation

Create additional networks for service isolation:

```bash
docker network create kompose-internal
docker network create kompose-public
```

Update stack configurations to use appropriate networks.

## Troubleshooting

### Initialization Fails

**Dependency check fails:**
```bash
# Install missing dependencies
# Ubuntu/Debian
sudo apt-get install docker.io docker-compose git

# Retry initialization
./kompose.sh init
```

**Permission denied:**
```bash
# Make scripts executable
chmod +x kompose*.sh

# Retry
./kompose.sh init
```

**Docker network creation fails:**
```bash
# Check Docker is running
docker ps

# Remove existing network if corrupted
docker network rm kompose

# Retry
./kompose.sh init
```

### Dependency Installation Fails

**pnpm not found:**
```bash
# Install pnpm globally
npm install -g pnpm

# Manually install dependencies
cd _docs && pnpm install
cd ../kmps && pnpm install
```

**Permission errors during pnpm install:**
```bash
# Fix npm permissions
mkdir -p ~/.npm-global
npm config set prefix ~/.npm-global
echo 'export PATH=~/.npm-global/bin:$PATH' >> ~/.bashrc
source ~/.bashrc

# Reinstall pnpm
npm install -g pnpm
```

**Dependencies fail with network errors:**
```bash
# Configure pnpm to use different registry
pnpm config set registry https://registry.npmmirror.com/

# Retry installation
cd _docs && pnpm install
```

### Configuration Issues

**Wrong environment activated:**
```bash
# Check current mode
./kompose.sh setup status

# Switch if needed
./kompose.sh setup local   # or prod
```

**Missing configuration files:**
```bash
# Restore from backups
ls backups/config_backup_*/

# Copy files back
cp backups/config_backup_<timestamp>/.env .
cp backups/config_backup_<timestamp>/domain.env .
```

**Secrets file issues:**
```bash
# Recreate from template
cp secrets.env.template secrets.env

# Edit with your values
nano secrets.env
```

## Re-initialization

To start fresh:

```bash
# Backup current config
./kompose.sh setup backup

# Stop all services
./kompose.sh down

# Remove configuration
rm .env domain.env secrets.env

# Re-run initialization
./kompose.sh init
```

## Next Steps

After successful initialization:

::card-group
::card
---
title: Quick Start Guide
icon: i-heroicons-rocket-launch
to: /guide/quick-start
---
Start using Kompose right away
::

::card
---
title: Stack Management
icon: i-heroicons-squares-2x2
to: /guide/stack-management
---
Learn to manage your stacks
::

::card
---
title: Configuration Guide
icon: i-heroicons-cog-6-tooth
to: /guide/configuration
---
Deep dive into configuration
::

::card
---
title: Troubleshooting
icon: i-heroicons-wrench-screwdriver
to: /guide/troubleshooting
---
Solve common issues
::
::

## Summary

The initialization process:
- âœ… Validates your system dependencies
- âœ… Sets up environment files for your chosen mode
- âœ… Installs all necessary project dependencies
- âœ… Creates Docker networking infrastructure
- âœ… Prepares directory structure
- âœ… Provides clear next steps

You're now ready to start using Kompose! ðŸš€
