# ===================================================================
# KOMPOSE - Local Development Configuration
# ===================================================================
# This file is for LOCAL DEVELOPMENT ONLY
# Copy to .env for local development: cp .env.local .env
# Or use: ./kompose.sh setup local
# ===================================================================

# -------------------------------------------------------------------
# Domain Configuration
# -------------------------------------------------------------------
# Load local domain configuration
[ -f "$(dirname "${BASH_SOURCE[0]:-$0}")/domain.env.local" ] && source "$(dirname "${BASH_SOURCE[0]:-$0}")/domain.env.local" 2>/dev/null || true

# Build local URLs (using localhost with ports)
TRAEFIK_HOST_PROXY=localhost:8080
TRAEFIK_HOST_AUTH=localhost:8180
TRAEFIK_HOST_AUTO=localhost:3000
TRAEFIK_HOST_CHAIN=localhost:5678
TRAEFIK_HOST_CHAT=localhost:8085
TRAEFIK_HOST_MAIL=localhost:8025
TRAEFIK_HOST_CODE=localhost:3001
TRAEFIK_HOST_DOCS=localhost:3003
TRAEFIK_HOST_HOME=localhost:8123
TRAEFIK_HOST_LINK=localhost:3009
TRAEFIK_HOST_TRACK=localhost:3007
TRAEFIK_HOST_VAULT=localhost:8081
TRAEFIK_HOST_VPN=localhost:51821
TRAEFIK_HOST_OAUTH2=localhost:4180
TRAEFIK_HOST_MANAGE=localhost:3100
TRAEFIK_HOST_ZIGBEE=localhost:8080

# -------------------------------------------------------------------
# Global Settings
# -------------------------------------------------------------------
# Network name used by all stacks
NETWORK_NAME=kompose

# Default timezone
TIMEZONE=Europe/Amsterdam

# Admin email (local)
ADMIN_EMAIL=dev@localhost

# Email/SMTP Settings (disabled for local)
EMAIL_TRANSPORT=smtp
EMAIL_FROM=dev@localhost
EMAIL_SMTP_HOST=localhost
EMAIL_SMTP_PORT=1025
EMAIL_SMTP_USER=dev@localhost

# Disable Traefik by default for local dev
TRAEFIK_ENABLED=false

# ===================================================================
# CORE STACK CONFIGURATION
# ===================================================================
CORE_COMPOSE_PROJECT_NAME=core

# PostgreSQL Configuration
CORE_POSTGRES_IMAGE=postgres:16-alpine
DB_USER=kompose
CORE_DB_NAME=kompose
CORE_DB_PORT=5432
CORE_DB_HOST=localhost  # Use localhost for direct access
CORE_POSTGRES_MAX_CONNECTIONS=100
CORE_POSTGRES_SHARED_BUFFERS="256MB"

# Redis Configuration
CORE_REDIS_IMAGE=redis:7-alpine
CORE_REDIS_PORT=6379
CORE_REDIS_HOST=localhost

# Mosquitto MQTT Configuration
CORE_MOSQUITTO_IMAGE=eclipse-mosquitto:2
CORE_MQTT_PORT=1883
CORE_MQTT_WS_PORT=9001

# Redis Commander (Web UI)
CORE_REDIS_COMMANDER_IMAGE=rediscommander/redis-commander:latest
CORE_REDIS_API_USER=admin
CORE_REDIS_API_PORT=8081
CORE_REDIS_API_TRAEFIK_HOST=localhost:8081

# ===================================================================
# AUTH STACK CONFIGURATION
# ===================================================================
AUTH_COMPOSE_PROJECT_NAME=auth

# Keycloak Configuration
AUTH_DOCKER_IMAGE=quay.io/keycloak/keycloak:latest
AUTH_DB_NAME=keycloak
AUTH_KEYCLOAK_ADMIN_USERNAME=admin
AUTH_KC_HTTP_PORT=8180  # Direct port for local access

# OAuth2 Proxy Configuration (Optional for local)
AUTH_OAUTH2_PROXY_HOST=localhost:4180
AUTH_OAUTH2_CLIENT_ID=kompose-sso

# ===================================================================
# KMPS STACK CONFIGURATION
# ===================================================================
KMPS_COMPOSE_PROJECT_NAME=kmps
KMPS_DB_NAME=kmps
KMPS_TRAEFIK_HOST=localhost:3100
KMPS_APP_PORT=3100
KMPS_API_PORT=8080
KMPS_API_HOST=0.0.0.0

# Keycloak Client Configuration
KMPS_CLIENT_ID=kmps-admin
KMPS_REALM=kompose

# Kompose Root Path
KOMPOSE_ROOT=/home/valknar/Projects/kompose

# ===================================================================
# HOME STACK CONFIGURATION
# ===================================================================
HOME_COMPOSE_PROJECT_NAME=home

# Home Assistant Configuration
HOME_HOMEASSISTANT_IMAGE=ghcr.io/home-assistant/home-assistant:stable
HOME_HOMEASSISTANT_PORT=8123

# Matter Server Configuration
HOME_MATTER_SERVER_IMAGE=ghcr.io/home-assistant-libs/python-matter-server:stable

# Zigbee2MQTT Configuration
HOME_ZIGBEE2MQTT_IMAGE=koenkk/zigbee2mqtt:latest
HOME_ZIGBEE2MQTT_PORT=8080

# ESPHome Configuration
HOME_ESPHOME_IMAGE=ghcr.io/esphome/esphome:stable

# ===================================================================
# VPN STACK CONFIGURATION
# ===================================================================
VPN_COMPOSE_PROJECT_NAME=vpn

# WireGuard Configuration
VPN_WG_HOST=localhost
VPN_WG_PORT=51820
VPN_WG_PERSISTENT_KEEPALIVE=25
VPN_WG_DEFAULT_DNS=1.1.1.1,1.0.0.1
VPN_WG_DEFAULT_ADDRESS=10.8.0.x
VPN_WG_ALLOWED_IPS=10.8.0.0/24
VPN_WG_MTU=1420
VPN_APP_PORT=51821

# ===================================================================
# MESSAGING STACK CONFIGURATION
# ===================================================================
MESSAGING_COMPOSE_PROJECT_NAME=messaging

# Gotify Configuration
MESSAGING_GOTIFY_IMAGE=gotify/server:latest
MESSAGING_GOTIFY_PORT=8085
MESSAGING_GOTIFY_TRAEFIK_HOST=localhost:8085
MESSAGING_GOTIFY_DEFAULTUSER_NAME=admin

# Mailhog Configuration
MESSAGING_MAILHOG_IMAGE=mailhog/mailhog:latest
MESSAGING_MAILHOG_PORT=8025
MESSAGING_MAILHOG_OUTGOING_SMTP_ENABLED=false

# ===================================================================
# CHAIN STACK CONFIGURATION
# ===================================================================
CHAIN_COMPOSE_PROJECT_NAME=chain

# n8n Configuration
CHAIN_N8N_IMAGE=n8nio/n8n:latest
CHAIN_N8N_PORT=5678
CHAIN_N8N_DB_NAME=n8n
CHAIN_N8N_BASIC_AUTH_ACTIVE=true
CHAIN_N8N_BASIC_AUTH_USER=admin
CHAIN_N8N_WEBHOOK_URL=http://localhost:5678

# Semaphore Configuration
CHAIN_SEMAPHORE_IMAGE=semaphoreui/semaphore:latest
CHAIN_SEMAPHORE_PORT=3000
CHAIN_SEMAPHORE_DB_NAME=semaphore
CHAIN_SEMAPHORE_ADMIN_USERNAME=admin
CHAIN_SEMAPHORE_ADMIN_NAME=Admin

# ===================================================================
# CODE STACK CONFIGURATION
# ===================================================================
CODE_COMPOSE_PROJECT_NAME=code

# Gitea Configuration
CODE_GITEA_IMAGE=gitea/gitea:latest
CODE_GITEA_PORT_HTTP=3001
CODE_GITEA_PORT_SSH=2222
CODE_GITEA_DB_NAME=gitea
CODE_GITEA_APP_NAME="Kompose Git (Local)"
CODE_GITEA_RUN_MODE=dev
CODE_GITEA_UID=1000
CODE_GITEA_GID=1000
CODE_GITEA_DISABLE_REGISTRATION=false
CODE_GITEA_REQUIRE_SIGNIN=false
CODE_GITEA_EMAIL_CONFIRM=false
CODE_GITEA_LOG_LEVEL=Info

# Gitea Actions Runner Configuration
CODE_GITEA_RUNNER_IMAGE=gitea/act_runner:latest
CODE_GITEA_RUNNER_NAME=kompose-runner-1
CODE_GITEA_RUNNER_LABELS=ubuntu-latest:docker://node:16-bullseye

# ===================================================================
# PROXY STACK CONFIGURATION (Optional for local)
# ===================================================================
PROXY_COMPOSE_PROJECT_NAME=proxy

# Traefik Configuration
PROXY_DOCKER_IMAGE=traefik:latest
PROXY_PORT_HTTP=80
PROXY_PORT_HTTPS=443
PROXY_PORT_DASHBOARD=8080
PROXY_LOG_LEVEL=DEBUG

# ===================================================================
# LINK STACK CONFIGURATION
# ===================================================================
LINK_COMPOSE_PROJECT_NAME=link

# Linkwarden Configuration
LINK_DOCKER_IMAGE=ghcr.io/linkwarden/linkwarden:latest
LINK_DB_NAME=linkwarden
LINK_APP_PORT=3000
LINK_DISABLE_SCREENSHOT=false
LINK_DISABLE_ARCHIVE=false
LINK_DISABLE_REGISTRATION=false

# ===================================================================
# TRACK STACK CONFIGURATION
# ===================================================================
TRACK_COMPOSE_PROJECT_NAME=track

# Umami Configuration
TRACK_DOCKER_IMAGE=ghcr.io/umami-software/umami:postgresql-latest
TRACK_DB_NAME=umami
MQTT_ENABLED=true

# ===================================================================
# VAULT STACK CONFIGURATION
# ===================================================================
VAULT_COMPOSE_PROJECT_NAME=vault

# Vaultwarden Configuration
VAULT_DOCKER_IMAGE=vaultwarden/server:latest
VAULT_DB_NAME=vaultwarden
VAULT_APP_PORT=80
VAULT_WEBSOCKET_ENABLED=true
VAULT_SIGNUPS_ALLOWED=true
VAULT_MQTT_ENABLED=true

# ===================================================================
# WATCH STACK CONFIGURATION
# ===================================================================
WATCH_COMPOSE_PROJECT_NAME=watch

# Prometheus Configuration
WATCH_PROMETHEUS_IMAGE=prom/prometheus:latest
WATCH_PROMETHEUS_PORT=9090
WATCH_PROMETHEUS_RETENTION=30d

# Grafana Configuration
WATCH_GRAFANA_IMAGE=grafana/grafana:latest
WATCH_GRAFANA_PORT=3010
WATCH_GRAFANA_ADMIN_USER=admin
WATCH_GRAFANA_DB_NAME=grafana
WATCH_GRAFANA_DB_USER=grafana
WATCH_GRAFANA_PLUGINS=grafana-clock-panel,grafana-simple-json-datasource,grafana-piechart-panel,grafana-worldmap-panel

# OpenTelemetry Configuration
WATCH_OTEL_IMAGE=otel/opentelemetry-collector-contrib:latest
WATCH_OTEL_GRPC_PORT=4317
WATCH_OTEL_HTTP_PORT=4318
WATCH_OTEL_HEALTH_PORT=13133
WATCH_OTEL_ZPAGES_PORT=55679

# Postgres Exporter Configuration
WATCH_POSTGRES_EXPORTER_IMAGE=prometheuscommunity/postgres-exporter:latest
WATCH_POSTGRES_EXPORTER_USER=kompose
WATCH_POSTGRES_EXPORTER_DB=kompose
WATCH_POSTGRES_EXPORTER_PORT=9187

# Redis Exporter Configuration
WATCH_REDIS_EXPORTER_IMAGE=oliver006/redis_exporter:latest
WATCH_REDIS_EXPORTER_PORT=9121

# MQTT Exporter Configuration
WATCH_MQTT_EXPORTER_IMAGE=kpetrem/mqtt-exporter:latest
WATCH_MQTT_EXPORTER_TOPIC=#
WATCH_MQTT_V5_PROTOCOL=False
WATCH_MQTT_EXPORTER_PORT=9000

# cAdvisor Configuration
WATCH_CADVISOR_IMAGE=gcr.io/cadvisor/cadvisor:latest
WATCH_CADVISOR_PORT=8082

# Node Exporter Configuration
WATCH_NODE_EXPORTER_IMAGE=prom/node-exporter:latest

# Blackbox Exporter Configuration
WATCH_BLACKBOX_EXPORTER_IMAGE=prom/blackbox-exporter:latest
WATCH_BLACKBOX_EXPORTER_PORT=9115

# Loki Configuration
WATCH_LOKI_IMAGE=grafana/loki:latest
WATCH_LOKI_PORT=3100

# Promtail Configuration
WATCH_PROMTAIL_IMAGE=grafana/promtail:latest
WATCH_PROMTAIL_PORT=9080

# Alertmanager Configuration
WATCH_ALERTMANAGER_IMAGE=prom/alertmanager:latest
WATCH_ALERTMANAGER_PORT=9093

# ===================================================================
# DOCS STACK CONFIGURATION
# ===================================================================
DOCS_COMPOSE_PROJECT_NAME=docs
DOCS_DOCKER_IMAGE=joseluisq/static-web-server:latest

# ===================================================================
# Local Development Notes
# ===================================================================
# 1. Services accessible directly via ports (no domain routing)
# 2. No SSL/TLS - everything runs on HTTP
# 3. Traefik is optional (set TRAEFIK_ENABLED=true if needed)
# 4. Database host is localhost for direct connection
# 5. Simplified authentication (no OAuth2 Proxy by default)
#
# To activate this configuration:
#   ./kompose.sh setup local
#   OR
#   cp .env.local .env
#   cp domain.env.local domain.env
#
# Services will be available at:
#   - PostgreSQL: localhost:5432
#   - Redis: localhost:6379
#   - Keycloak: http://localhost:8180
#   - KMPS: http://localhost:3100
#   - Gitea: http://localhost:3001
#   - n8n: http://localhost:5678
#   - Home Assistant: http://localhost:8123
#   - etc.
# ===================================================================

# ===================================================================
# AUTH CHAIN CODE CORE HOME KMPS LINK MESSAGING PROXY TRACK VAULT VPN WATCH BLOG NEWS SEXY STACK CONFIGURATION
# ===================================================================
AUTH CHAIN CODE CORE HOME KMPS LINK MESSAGING PROXY TRACK VAULT VPN WATCH BLOG NEWS SEXY_COMPOSE_PROJECT_NAME=auth chain code core home kmps link messaging proxy track vault vpn watch blog news sexy

