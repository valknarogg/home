# =================================================================
# CODE Stack Configuration - Git Repository & CI/CD
# =================================================================

# Stack identification
COMPOSE_PROJECT_NAME=code

# Network configuration
NETWORK_NAME=kompose
TZ=Europe/Paris
TIMEZONE=Europe/Paris

# =================================================================
# Gitea Configuration
# =================================================================

# Docker images
GITEA_IMAGE=gitea/gitea:latest
GITEA_RUNNER_IMAGE=gitea/act_runner:latest

# User/Group IDs for file permissions
GITEA_UID=1000
GITEA_GID=1000

# Database configuration
GITEA_DB_NAME=gitea

# Traefik configuration
GITEA_TRAEFIK_HOST=${TRAEFIK_HOST_CODE}

# Port configuration
GITEA_HTTP_PORT=3000
GITEA_SSH_PORT=2222

# Application settings
GITEA_DISABLE_REGISTRATION=false
GITEA_REQUIRE_SIGNIN=false
GITEA_EMAIL_CONFIRM=false

# Logging
GITEA_LOG_LEVEL=Info

# Email configuration
EMAIL_SMTP_PROTOCOL=smtp

# Webhook configuration
WEBHOOK_ALLOWED_HOSTS=*
WEBHOOK_SKIP_TLS=false

# =================================================================
# Gitea Actions Runner Configuration
# =================================================================

GITEA_RUNNER_NAME=kompose-runner-1
GITEA_RUNNER_LABELS=ubuntu-latest:docker://node:16-bullseye,ubuntu-22.04:docker://node:16-bullseye,debian-latest:docker://node:16-bullseye

# =================================================================
# Core Stack Integration
# =================================================================

# PostgreSQL (from core stack)
DB_HOST=core-postgres
DB_USER=kompose

# Redis (from core stack)
REDIS_HOST=core-redis

# =================================================================
# Messaging Stack Integration
# =================================================================

# SMTP (from messaging stack - mailhog)
EMAIL_SMTP_HOST=mailhog
EMAIL_SMTP_PORT=1025
EMAIL_SMTP_USER=
EMAIL_SMTP_PASSWORD=

# =================================================================
# Shared Configuration
# =================================================================

# NOTE: Secrets are stored in root secrets.env file
# Required secrets for this stack:
#   - DB_PASSWORD=your_postgres_password
#   - REDIS_PASSWORD=your_redis_password
#   - CODE_RUNNER_TOKEN=generate_with_gitea_ui
#   - GITEA_SECRET_KEY=generate_with_openssl_rand_hex_64
#   - GITEA_INTERNAL_TOKEN=generate_with_openssl_rand_hex_105
#   - GITEA_OAUTH2_JWT_SECRET=generate_with_openssl_rand_base64_32
#   - GITEA_METRICS_TOKEN=generate_with_openssl_rand_hex_32
#   - EMAIL_FROM=git@yourdomain.com
#   - TRAEFIK_HOST_CODE=code.yourdomain.com
